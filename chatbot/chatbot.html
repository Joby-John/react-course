<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatBot</title>
</head>
<body>

    <div class="js-container">
    </div>
    
    <!-- for react.js -->
    <script src="https://unpkg.com/supersimpledev/react.js"></script>
    <!-- for react-dom -->
    <script src="https://unpkg.com/supersimpledev/react-dom.js"></script>
    <script src="https://unpkg.com/supersimpledev/chatbot.js"></script>
    <!-- for babel -->
    <script src="https://unpkg.com/supersimpledev/babel.js"></script>

    <script type="text/babel">

        
        function ChatInput({chatMessages, setChatMessages}){

            const [inputText, setInputText] = React.useState('');

            function saveInputText(event){
                setInputText(event.target.value);
            }

            function sendMessage(){
                const newChatMessages = [
                            ...chatMessages,
                            {
                                message:inputText,
                                sender:'user',
                                id:crypto.randomUUID()
                            }
                        ]


                const respose = Chatbot.getResponse(inputText);

                setChatMessages(
                    [
                        ...newChatMessages,
                        {
                            message:respose,
                            sender:'robot',
                            id:crypto.randomUUID()
                        }
                    ]
                )

                setInputText('');

                    
                    
            }

            return ( 
                <>
                    <input 
                        type="text" 
                        placeholder="Send a message to Chatbot" 
                        size="30"
                        onChange={saveInputText}
                        value={inputText}
                        
                    /> 
                    <button
                        onClick={sendMessage} 
                    >Send</button>
                </>
            );
        }

        function ChatMessage({message, sender}){
            //const message = props.message;
            //const sender = props.sender;
            //const {message, sender} = props;

            /*
            if(sender === 'robot'){  
                return(
                     <div>
                        <img src="./images/robot.png" alt="profile picture" width="50"/>
                        {message}
                        
                    </div>
                );
                
            }
           */

            return (
                <div>
                    {
                        sender === 'robot' && (
                            <img src="./images/robot.png" 
                                 alt="profile picture" 
                                 width="50"/>
                            )  
                    }

                    {message}

                    {
                    sender === 'user' && (
                            <img src="./images/user.png" 
                                 alt="profile picture" 
                                 width="50"/>
                                )
                    }
                </div>
            );
        }

        function ChatMessages({chatMessages}){

            return (
                <>
                    {
                        chatMessages.map((chatMessage)=>{
                            return (
                                <ChatMessage
                                    key={chatMessage.id}
                                    message={chatMessage.message}
                                    sender={chatMessage.sender}
                                />
                            )
                        })
                    }
                </>
            );


        }

        function App(){
            //syntax of useState
            //const [currentValue, setCurrentValue] = React.useState(initialValue);

             const [chatMessages, setChatMessages] = React.useState([
                {
                    id:'id1',
                    message: "Hello ChatBot",
                    sender: "user"
                },
                
                {
                    id:'id2',
                    message: "Hello! How can I help you",
                    sender: "robot"
                },

                {
                    id:'id3',
                    message: "Can you get me todays date?",
                    sender: "user"
                },

                {
                    id:'id4',
                    message: "Today is December 19",
                    sender: "robot"
                }
            ]);

            //const [chatMessages, setChatMessages] = array;
            //const chatMessages = array[0];
            //const setChatMessages = array[1];

            return (
                <>
                    <ChatInput 
                        chatMessages={chatMessages}
                        setChatMessages={setChatMessages}
                    />

                    <ChatMessages
                        chatMessages={chatMessages}
                    />
                
                </>
            );
        }

        const container = document.querySelector('.js-container');
        ReactDOM.createRoot(container).render(<App/>);
    </script>
</body>
</html>



